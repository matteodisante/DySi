.. _plot-interpretation:

Output Plot Interpretation Guide
=================================

This guide explains how to interpret all plots generated by DySi simulations.
Understanding these plots is essential for analyzing flight performance, validating
designs, and identifying potential issues.

.. note::
   
   DySi generates plots automatically in the ``outputs/<simulation_name>/curves/`` 
   directory, organized into subdirectories by category.

Plot Organization
-----------------

Plots are organized into the following categories:

.. list-table::
   :header-rows: 1
   :widths: 20 80

   * - Category
     - Description
   * - ``motor/``
     - Motor performance characteristics (thrust, mass, Kn)
   * - ``rocket/``
     - Rocket aerodynamics (drag coefficient, CP position)
   * - ``stability/``
     - Stability analysis (margins, CP/CoM evolution)
   * - ``environment/``
     - Atmospheric conditions (wind, pressure, temperature)
   * - ``flight/``
     - Flight data (trajectory, kinematics, forces, energy, attitude)

----

Motor Plots
-----------

thrust_curve.png
~~~~~~~~~~~~~~~~

**Purpose**: Shows motor thrust vs time with performance metrics.

**Key Features**:

- **Blue line**: Thrust curve
- **Shaded area**: Total impulse (area under curve)
- **Green dashed line**: Average thrust
- **Red point**: Maximum thrust
- **Orange/red vertical lines**: Burn start/burnout times

**What to Look For**:

‚úÖ **Smooth thrust curve**: Indicates stable burn
‚úÖ **Peak thrust occurs early**: Typical for most motors
‚úÖ **Total impulse**: Should match motor specifications
‚ö†Ô∏è **Irregular spikes**: May indicate measurement errors or actual motor irregularities

**Example Interpretation**:

.. code-block:: text

   Max Thrust: 1520 N @ 0.15 s
   Average Thrust: 950 N
   Total Impulse: 7579 N¬∑s
   Burn Duration: 7.98 s
   
   ‚úì Motor performance matches manufacturer specs
   ‚úì Peak thrust early ‚Üí good initial acceleration
   ‚úì Long burn ‚Üí high altitude potential

mass_evolution.png
~~~~~~~~~~~~~~~~~~

**Purpose**: Shows how motor total mass and propellant mass change during burn.

**Key Lines**:

- **Blue line**: Total motor mass (structure + propellant)
- **Red line**: Propellant mass only

**What to Look For**:

‚úÖ **Propellant reaches zero at burnout**: Complete burn
‚úÖ **Total mass > 0 at burnout**: Motor case remains
‚úÖ **Smooth decrease**: Steady propellant consumption

kn_curve.png
~~~~~~~~~~~~

**Purpose**: Shows burn area to throat area ratio (Kn) vs time.

**Interpretation**:

- **Kn > 200**: Very aggressive burn (high chamber pressure)
- **Kn = 100-200**: Typical range for most motors
- **Kn < 100**: Conservative burn (lower chamber pressure)
- **Increasing Kn**: Progressive burn (grain burning inward)
- **Decreasing Kn**: Regressive burn (grain burning outward)

----

Rocket Plots
------------

drag_coefficient.png
~~~~~~~~~~~~~~~~~~~~

**Purpose**: Shows how drag coefficient (Cd) varies with Mach number.

**Critical Regions**:

1. **Subsonic (M < 0.8)**: Relatively constant Cd
2. **Transonic (M = 0.8-1.2)**: **Rapid Cd increase** - peak drag
3. **Supersonic (M > 1.2)**: Cd decreases and stabilizes

**What to Look For**:

‚úÖ **Smooth curve**: Good aerodynamic design
‚ö†Ô∏è **Sharp spikes**: May indicate design issues or airflow separation
üìä **Peak around M=1.0**: Normal transonic drag rise

**Typical Values**:

- Subsonic: Cd ‚âà 0.3-0.5
- Transonic peak: Cd ‚âà 0.5-0.8
- Supersonic: Cd ‚âà 0.3-0.4

cp_position_vs_mach.png
~~~~~~~~~~~~~~~~~~~~~~~

**Purpose**: Shows how Center of Pressure (CP) moves with Mach number.

**Why CP Moves**:

- Shock wave formation changes pressure distribution
- Fin effectiveness varies with Mach number
- Nose cone pressure patterns change

**What to Look For**:

‚úÖ **CP shifts aft (more negative)** at transonic: Improves stability
‚ö†Ô∏è **CP shifts forward** at transonic: Reduces stability margin
üìè **Shift magnitude**: Typical shifts are 5-15 cm for high-power rockets

----

Stability Plots
---------------

stability_envelope.png
~~~~~~~~~~~~~~~~~~~~~~

**Purpose**: Shows actual stability margin throughout flight with safety zones.

**Color Zones**:

.. list-table::
   :header-rows: 1

   * - Zone
     - Color
     - Margin Range
     - Interpretation
   * - Dangerous
     - Red
     - < 1.0 cal
     - ‚ùå Unstable - DO NOT FLY
   * - Marginal
     - Yellow
     - 1.0-1.5 cal
     - ‚ö†Ô∏è Risky - subsonic only
   * - Safe
     - Light green
     - 1.5-2.0 cal
     - ‚úÖ Acceptable
   * - Optimal
     - Dark green
     - 2.0-2.5 cal
     - ‚úÖ‚úÖ Excellent
   * - Overstable
     - Blue
     - > 2.5 cal
     - üîπ Very stable

**Critical Events Marked**:

- **Burnout**: Often minimum stability point
- **Max-Q**: Maximum dynamic pressure
- **Apogee**: End of powered/coast flight

**What to Look For**:

‚úÖ **Entire curve in green zones**: Safe flight
‚úÖ **Minimum margin > 1.5 cal**: Good design
‚ö†Ô∏è **Dips into yellow**: Only acceptable if brief and subsonic
‚ùå **Any red zone**: Rocket is unstable - redesign needed

stability_margin_surface.png
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Purpose**: 3D surface showing how stability margin varies with both Mach and time.

**Axes**:

- **X-axis**: Time (s)
- **Y-axis**: Mach number
- **Z-axis (color)**: Stability margin (calibers)

**Interpretation**:

- **Ridge at high Mach**: CP moves aft ‚Üí stability improves
- **Valley at low time, high Mach**: Transonic crossing with low propellant
- **Minimum point**: Critical design point

stability_cp_travel.png
~~~~~~~~~~~~~~~~~~~~~~~

**Purpose**: Shows CP position vs Mach with flight regime annotations.

**Regime Regions**:

- **Subsonic**: M < 0.8 (light blue)
- **Transonic**: M = 0.8-1.2 (light red) - **CRITICAL**
- **Supersonic**: M > 1.2 (light green)

**What to Look For**:

- **Actual flight max Mach**: Red vertical line
- **CP travel magnitude**: How much CP moves
- **Direction**: Aft movement (negative) improves stability

----

.. _flight-plots-interpretation:

Flight Data Plots
-----------------

trajectory_3d.png
~~~~~~~~~~~~~~~~~

**Purpose**: Visualizes the complete 3D flight path with projections on XY, XZ, and YZ planes.

**Components**:

- **Main trajectory**: 3D flight path (blue line)
- **XY projection**: Ground track (gray dashed) - shows horizontal drift
- **XZ projection**: Side view (gray dashed) - shows altitude profile
- **YZ projection**: Front view (gray dashed) - shows lateral motion

**Key Points**:

- **Green circle**: Launch point
- **Red triangle**: Apogee (highest altitude)
- **Orange square**: Landing point

**What to Look For**:

‚úÖ **Smooth trajectory**: No erratic path changes
‚úÖ **Vertical ascent**: Minimal horizontal drift in early flight
‚úÖ **Downwind drift**: Ground track shows wind effect
‚ö†Ô∏è **Large lateral deviations**: Strong crosswinds or instability
‚ö†Ô∏è **Zigzag pattern**: Possible control issues or instability

position_data.png
~~~~~~~~~~~~~~~~~

**Purpose**: Shows the position components (x, y, z) as they evolve over time.

**Subplot Layout**:

1. **X Position** (East): Horizontal displacement eastward (m)
2. **Y Position** (North): Horizontal displacement northward (m)
3. **Z Position** (Altitude): Vertical position above ground (m)

**What to Look For**:

‚úÖ **X and Y near zero early**: Vertical ascent with minimal drift
‚úÖ **Z reaches apogee smoothly**: Parabolic altitude profile
‚úÖ **Apogee marked**: Red triangle shows maximum altitude
‚ö†Ô∏è **Large X or Y displacement early**: Excessive tilt or wind drift
‚ö†Ô∏è **Irregular Z curve**: Possible thrust irregularities

**Relationship to other plots**:

- **Derivatives**: Velocities (Vx, Vy, Vz) are derivatives of positions
- **Wind effect**: X and Y show cumulative drift due to wind
- **Ground track**: X-Y projection visible in trajectory_3d.png

linear_kinematics_data.png
~~~~~~~~~~~~~~~~~~~~~~~~~~

**Purpose**: Shows velocity and acceleration components in all three axes plus total magnitudes.

**Subplot Layout**:

1. **X Component** (East): Vx (m/s) and Ax (m/s¬≤)
2. **Y Component** (North): Vy (m/s) and Ay (m/s¬≤)
3. **Z Component** (Altitude): Vz (m/s) and Az (m/s¬≤)
4. **Total Magnitude**: Speed and Acceleration

**Color Convention**:

- **Blue line** (left axis): Velocity (m/s)
- **Orange dashed** (right axis): Acceleration (m/s¬≤)

**What to Look For**:

‚úÖ **Vz peaks then decreases**: Normal parabolic trajectory
‚úÖ **Large Az spike at ignition**: Thrust acceleration
‚úÖ **Az drops to -9.8 m/s¬≤ after burnout**: Free fall (gravity only)
‚úÖ **Small Vx, Vy compared to Vz**: Vertical flight with minimal drift
‚ö†Ô∏è **Large horizontal velocities early**: Excessive tilt or instability
‚ö†Ô∏è **Irregular acceleration**: Motor thrust irregularities

flight_path_angle_data.png
~~~~~~~~~~~~~~~~~~~~~~~~~~

**Purpose**: Compares the rocket's attitude (where it's pointing) with its actual flight path direction.

**Subplots**:

1. **Flight Path vs Attitude Angle**:
   
   - **Blue line**: Attitude angle (where rocket points)
   - **Orange dashed**: Flight path angle (actual trajectory direction)
   - Small difference indicates low drag (rocket points where it's going)

2. **Lateral Attitude Angle** (green line):
   
   - Deviation from vertical plane containing velocity vector
   - Shows yaw motion or corkscrew pattern

**What to Look For**:

‚úÖ **Both angles similar**: Rocket flying in direction it's pointing (low AoA)
‚úÖ **Both angles near 90¬∞ early**: Vertical ascent
‚úÖ **Both decrease after apogee**: Ballistic descent
‚ö†Ô∏è **Large difference**: High angle of attack (significant drag)
‚ö†Ô∏è **Large lateral angle**: Rocket yawing or precessing significantly

attitude_data.png
~~~~~~~~~~~~~~~~~

**Purpose**: Shows rocket orientation using Euler angles.

**Subplot Components**:

1. **Attitude Angle**: Overall tilt from vertical
2. **Psi (œà)**: Precession - rotation around vertical axis
3. **Theta (Œ∏)**: Nutation - nodding motion
4. **Phi (œÜ)**: Spin - rotation around rocket axis

**What to Look For**:

‚úÖ **Small attitude angle (< 5¬∞)**: Stable, vertical flight
‚úÖ **Gradual precession**: Normal wind response
‚ö†Ô∏è **Large nutation (> 10¬∞)**: Possible instability or wind gusts
‚ö†Ô∏è **Rapid spin increase**: Check fin cant angle or asymmetries

**Normal Behavior**:

- Attitude angle increases slowly (weathercocking into wind)
- Nutation dampens over time
- Spin may increase if fins are canted

angular_kinematics_data.png
~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Purpose**: Shows angular velocities (œâ) and accelerations (Œ±) on three axes.

**Color Convention**:

- **Orange line** (left axis): Angular velocity (rad/s)
- **Blue line** (right axis): Angular acceleration (rad/s¬≤)

**What to Look For**:

‚úÖ **Oscillations dampen**: Rocket is naturally stable
‚úÖ **Small magnitudes**: Minimal rotation
‚ö†Ô∏è **Growing oscillations**: Instability or control issues
‚ö†Ô∏è **Large angular accelerations**: Rapid attitude changes

aerodynamic_forces.png
~~~~~~~~~~~~~~~~~~~~~~

**Purpose**: Shows aerodynamic forces and moments acting on rocket.

**Subplots**:

1. **Aerodynamic Lift**: Perpendicular to flight path
   
   - Resultant + components R1, R2
   - Peak during transonic crossing or high angle of attack

2. **Aerodynamic Drag**: Opposes motion
   
   - Should peak around Max-Q
   - Increases dramatically in transonic region

3. **Bending Moment**: Stress on rocket body
   
   - Resultant + components M1, M2
   - Critical for structural design
   - Peak at Max-Q or during wind gusts

4. **Spin Moment**: Torque around rocket axis
   
   - Due to fin cant or asymmetries
   - Controls spin rate

**What to Look For**:

‚úÖ **Lift forces reasonable**: Not excessive weathercocking
‚úÖ **Drag peak at Max-Q**: Normal behavior
‚ö†Ô∏è **Excessive bending moment**: Structural failure risk
üìä **Force magnitudes**: Scale with dynamic pressure

rail_buttons_forces.png
~~~~~~~~~~~~~~~~~~~~~~~

**Purpose**: Shows forces acting on rail buttons during launch phase (if rocket has rail buttons).

**Note**: This plot is only generated if the rocket configuration includes rail buttons.

**Subplots**:

1. **Upper Rail Button Forces**:
   
   - **Normal Force**: Perpendicular to rail - supports rocket weight component
   - **Shear Force**: Parallel to rail - friction and acceleration forces

2. **Lower Rail Button Forces**:
   
   - Same force components for lower button
   - Distribution depends on rocket CoM position

**What to Look For**:

‚úÖ **Forces drop to zero at rail exit**: Clean separation
‚úÖ **Normal forces positive**: Rocket stays on rail
‚úÖ **Reasonable magnitudes**: No excessive rail loads
‚ö†Ô∏è **Very high shear forces**: Possible binding or misalignment
üìä **Force asymmetry**: Check button placement vs CoM

**Typical Behavior**:
- Forces highest at ignition (weight + acceleration)
- Decrease as rocket accelerates and angle changes
- Drop to zero at ~0.5-2s (rail exit time)

energy_data.png
~~~~~~~~~~~~~~~

**Purpose**: Shows energy conservation and power during flight.

**Subplots**:

1. **Total Mechanical Energy**: Should decrease due to drag

2. **Energy Components**:
   
   - **Kinetic**: ¬Ωmv¬≤ - peaks at burnout
   - **Potential**: mgh - peaks at apogee

3. **Thrust Power**: Motor power output

4. **Drag Power**: Power dissipated by drag

**What to Look For**:

‚úÖ **Total energy decreases smoothly**: Energy conservation with drag loss
‚úÖ **KE peaks near burnout**: Good acceleration
‚úÖ **PE peaks at apogee**: Energy transfer complete
üìä **Thrust power matches motor**: Validation check

fluid_mechanics_data.png
~~~~~~~~~~~~~~~~~~~~~~~~

**Purpose**: Shows fluid flow parameters around rocket.

**Key Subplots**:

1. **Mach Number**: Speed relative to sound
   
   - M < 0.8: Subsonic
   - M = 0.8-1.2: Transonic (critical)
   - M > 1.2: Supersonic

2. **Reynolds Number**: Flow regime indicator
   
   - Higher Re ‚Üí turbulent flow
   - Affects drag and heat transfer

3. **Pressures**:
   
   - **Dynamic pressure**: ¬ΩœÅv¬≤ - structural loads
   - **Total pressure**: Static + dynamic
   - **Static pressure**: Atmospheric pressure

4. **Angle of Attack (AoA)**: Angle between velocity and rocket axis
   
   - Should be small (< 5¬∞) for stable flight
   - Large AoA ‚Üí high drag and possible instability

5. **Stream Velocity**: Apparent wind components

6. **Angle of Sideslip**: Lateral flow angle

**What to Look For**:

‚úÖ **Max Mach as expected**: Performance validation
‚úÖ **Small AoA after rail exit**: Good launch stability
‚úÖ **Dynamic pressure peak**: Defines Max-Q
‚ö†Ô∏è **Large AoA (> 10¬∞)**: Instability or strong winds

stability_and_control_data.png
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

**Purpose**: Shows stability margin and frequency response.

**Subplot 1 - Stability Margin**:

Critical event markers:

- **Red dashed**: Out of rail
- **Green dashed**: Burnout
- **Magenta dashed**: Apogee

**What to Look For**:

‚úÖ **Margin > 1.5 cal throughout**: Safe
‚úÖ **Minimum at burnout**: Expected (lightest mass, CP still subsonic)
‚ö†Ô∏è **Margin < 1.0 cal**: Unstable period

**Subplot 2 - Frequency Response**:

Shows how rocket responds to oscillations at different frequencies.

- **Peaks indicate resonances**: Natural frequencies
- **Lower frequency = slower oscillations**
- **Normalized amplitude**: Relative response strength

----

Environment Plots
-----------------

wind_profile.png
~~~~~~~~~~~~~~~~

**Purpose**: Shows wind speed and direction vs altitude.

**Components**:

- **Left axis**: Wind speed (m/s)
- **Right axis**: Wind direction (degrees)

**What to Look For**:

‚úÖ **Smooth wind profile**: Predictable conditions
‚ö†Ô∏è **Wind shear layers**: Sudden direction/speed changes
üìä **Peak wind altitude**: May coincide with Max-Q for maximum loads

atmospheric_profile.png
~~~~~~~~~~~~~~~~~~~~~~~

**Purpose**: Shows temperature, pressure, and density vs altitude.

**Uses**:

- Validate environment model
- Understand Mach number variation
- Check for atmospheric anomalies

----

Common Patterns and Issues
--------------------------

Normal Flight Patterns
~~~~~~~~~~~~~~~~~~~~~~

‚úÖ **Thrust curve**: Peak early, smooth decrease
‚úÖ **Stability margin**: Minimum at burnout, increases in transonic
‚úÖ **Attitude angle**: Small (< 5¬∞), gradual increase
‚úÖ **AoA**: Small after rail exit (< 3¬∞)
‚úÖ **Energy**: Smooth transfer from kinetic to potential

Warning Signs
~~~~~~~~~~~~~

‚ö†Ô∏è **Stability margin < 1.5 cal**: Marginal stability
‚ö†Ô∏è **Large attitude oscillations**: Possible instability
‚ö†Ô∏è **AoA > 10¬∞**: Excessive weathercocking or instability
‚ö†Ô∏è **Irregular thrust**: Motor quality issues
‚ö†Ô∏è **Growing angular oscillations**: Unstable flight

Critical Issues
~~~~~~~~~~~~~~~

‚ùå **Stability margin < 1.0 cal**: DO NOT FLY
‚ùå **Huge bending moments**: Structural failure risk
‚ùå **Extreme AoA (> 20¬∞)**: Complete instability
‚ùå **Negative stability margin**: Rocket unstable

----

Recommended Analysis Workflow
------------------------------

1. **Stability First**: Check ``stability_envelope.png``
   
   - Is minimum margin > 1.5 cal?
   - Any dangerous zones?

2. **Flight Performance**: Check ``energy_data.png`` and ``fluid_mechanics_data.png``
   
   - Does max Mach match expectations?
   - Is Max-Q reasonable?

3. **Structural Loads**: Check ``aerodynamic_forces.png``
   
   - Are bending moments acceptable?
   - Peak forces at Max-Q?

4. **Flight Quality**: Check ``attitude_data.png`` and ``angular_kinematics_data.png``
   
   - Small attitude deviations?
   - Oscillations dampen?

5. **Validation**: Cross-check all plots
   
   - Do motor specs match thrust curve?
   - Does energy conservation hold?
   - Are forces consistent with flight profile?

----

Advanced Topics
---------------

Static Margin vs Stability Margin
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

.. important::

   DySi uses **stability margin** (not static margin) in flight plots because
   it accounts for CP movement with Mach number.

**Difference**:

- **Static margin**: CP always at Mach=0 (conservative design metric)
- **Stability margin**: CP at actual Mach (realistic flight behavior)

**When to use each**:

- **Design phase**: Use static margin (conservative)
- **Analysis phase**: Use stability margin (accurate)

See :doc:`/developer/STABILITY_MARGIN_CLARIFICATION` for full explanation.

Transonic Effects
~~~~~~~~~~~~~~~~~

The transonic region (M = 0.8-1.2) is critical:

- **Drag coefficient peaks**: Up to 2x subsonic values
- **CP shifts aft**: Usually improves stability
- **Max-Q often occurs**: Maximum structural loads
- **Shock waves form**: Changes all aerodynamics

**Design implications**:

- Ensure stability margin > 2.0 cal in subsonic (buffer for transonic)
- Check structural strength for transonic loads
- Understand CP travel to predict stability variation

----

Exporting and Sharing Plots
----------------------------

All plots are saved as high-resolution PNG files (300 DPI) suitable for:

- Technical reports
- Competition documentation
- Publications
- Presentations

**File locations**::

   outputs/<simulation_name>/curves/
   ‚îú‚îÄ‚îÄ motor/
   ‚îÇ   ‚îú‚îÄ‚îÄ thrust_curve.png
   ‚îÇ   ‚îî‚îÄ‚îÄ ...
   ‚îú‚îÄ‚îÄ rocket/
   ‚îú‚îÄ‚îÄ stability/
   ‚îú‚îÄ‚îÄ environment/
   ‚îî‚îÄ‚îÄ flight/

See :doc:`/user/how_to_guides/export_data` for exporting raw data.

----

Further Reading
---------------

- :doc:`stability_analysis` - Complete stability theory
- :doc:`/user/how_to_guides/validate_design` - Design validation workflow
- :doc:`/user/tutorials/02_understanding_outputs` - Output tutorial
- :doc:`/developer/NEW_FLIGHT_PLOTS_IMPLEMENTATION` - Technical implementation details

.. seealso::

   **RocketPy Documentation**
   
   For deeper understanding of the underlying physics and methods:
   
   - `RocketPy Flight Plots <https://docs.rocketpy.org/en/latest/user/plots.html>`_
   - `RocketPy First Simulation <https://docs.rocketpy.org/en/latest/user/first_simulation.html>`_
