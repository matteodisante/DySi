# ==================================================================================
# COMPLETE ROCKET SIMULATION CONFIGURATION TEMPLATE
# ==================================================================================
# This template contains ALL available parameters with extensive inline documentation.
# Copy this file and customize it for your specific rocket design.
#
# Units Convention:
#   - Length: meters (m)
#   - Mass: kilograms (kg)
#   - Angle: degrees (deg) unless specified otherwise
#   - Time: seconds (s)
#   - Pressure: Pascals (Pa)
#   - Velocity: meters per second (m/s)
#   - Inertia: kg·m²
# ==================================================================================

# ==================================================================================
# ROCKET CONFIGURATION
# ==================================================================================
rocket:
  # Basic identification
  name: "MyRocket"  # Name of your rocket (string)
  
  # --- MASS PROPERTIES ---
  # Mass of rocket without motor (structural mass only)
  dry_mass_kg: 15.0  # (kg) - Include: airframe, nosecone, fins, parachute, avionics, etc.
  
  # --- INERTIA TENSOR ---
  # Moments and products of inertia about rocket's center of mass
  # For symmetric rockets about z-axis: I_xx = I_yy, and all products = 0
  inertia:
    ixx_kg_m2: 6.0   # (kg·m²) Lateral moment of inertia about x-axis
    iyy_kg_m2: 6.0   # (kg·m²) Lateral moment of inertia about y-axis (usually = I_xx)
    izz_kg_m2: 0.03  # (kg·m²) Axial moment of inertia about z-axis (roll axis)
    
    # Products of inertia (optional - default to 0 for symmetric designs)
    # Non-zero values indicate asymmetric mass distribution
    ixy_kg_m2: 0.0  # (kg·m²) Product of inertia I_12 (x-y coupling)
    ixz_kg_m2: 0.0  # (kg·m²) Product of inertia I_13 (x-z coupling)
    iyz_kg_m2: 0.0  # (kg·m²) Product of inertia I_23 (y-z coupling)
  
  # --- GEOMETRY ---
  geometry:
    caliber_m: 0.127  # (m) Rocket diameter (body tube outer diameter)
    length_m: 2.0     # (m) Total rocket length from nose tip to tail end
  
  # --- CENTER OF MASS & PRESSURE ---
  # Position of center of mass WITHOUT motor (measured from nose in nose_to_tail system)
  cg_location_m: 1.255  # (m) Distance from nose tip to CoM (without motor)
  
  # Position of center of pressure (measured from nose)
  # Set to null for automatic computation from aerodynamic surfaces
  cp_location_m: null  # (m) or null - Distance from nose tip to CoP
  
  # --- ECCENTRICITIES ---
  # Offsets from rocket centerline (for asymmetric configurations)
  # All values default to 0.0 for symmetric rockets
  eccentricities:
    cm_x_m: 0.0     # (m) Center of mass offset in x-direction
    cm_y_m: 0.0     # (m) Center of mass offset in y-direction
    cp_x_m: 0.0     # (m) Center of pressure offset in x-direction
    cp_y_m: 0.0     # (m) Center of pressure offset in y-direction
    thrust_x_m: 0.0 # (m) Thrust vector offset in x-direction (nozzle misalignment)
    thrust_y_m: 0.0 # (m) Thrust vector offset in y-direction (nozzle misalignment)
  
  # --- COORDINATE SYSTEM ---
  # Defines positive direction and origin point
  # Options: "nose_to_tail" (origin at nose, positive toward tail - RECOMMENDED)
  #          "tail_to_nose" (origin at tail, positive toward nose)
  coordinate_system: "nose_to_tail"
  
  # ================================================================================
  # AERODYNAMIC SURFACES
  # ================================================================================
  
  # --- NOSE CONE ---
  nose_cone:
    length_m: 0.5  # (m) Length of nose cone from tip to shoulder
    
    # Nose cone shape (affects drag and stability)
    # Options: "vonKarman"   - Von Karman ogive (lowest drag, best for supersonic)
    #          "conical"     - Simple cone (easy to manufacture)
    #          "ogive"       - Tangent ogive (good compromise)
    #          "elliptical"  - Elliptical shape
    #          "lvhaack"     - LV-Haack series (minimum drag for given length/diameter)
    #          "tangent"     - Tangent ogive variant
    kind: "vonKarman"
    
    position_m: 0.0  # (m) Position from nose (always 0.0 for nose cone)
  
  # --- FINS ---
  fins:
    count: 4  # Number of fins (typically 3 or 4 for stability)
    
    # Fin planform dimensions
    root_chord_m: 0.120  # (m) Length of fin where it meets body tube
    tip_chord_m: 0.060   # (m) Length of fin at outermost edge
    span_m: 0.100        # (m) Distance from body surface to fin tip
    thickness_m: 0.003   # (m) Fin thickness (for drag calculation)
    
    # Position of fin leading edge from nose
    position_m: 1.85  # (m) Distance from nose to fin leading edge
    
    # Fin cant angle for spin stabilization
    # 0 deg = no spin, 1-5 deg typical for spin stabilization
    cant_angle_deg: 0.0  # (degrees) Angle of fin relative to vertical
    
    # Custom airfoil profile (optional)
    # Provide path to .dat file with airfoil coordinates, or null for flat plate
    airfoil: null  # Path to airfoil file or null
    
    # Sweep angle (optional - computed from geometry if null)
    # sweep_angle_deg: null  # (degrees) Angle of leading edge from vertical
  
  # --- TAIL SECTION (BOAT TAIL) ---
  # Optional tapered section at rocket tail (reduces base drag)
  tail:
    enabled: false  # Set to true to include tail section
    top_radius_m: 0.0635     # (m) Radius at top of tail (typically = body radius)
    bottom_radius_m: 0.055   # (m) Radius at bottom of tail (smaller for boat tail)
    length_m: 0.060          # (m) Length of tapered section
    position_m: 1.940        # (m) Position of tail top from nose
  
  # --- RAIL BUTTONS ---
  # Launch rail guidance buttons
  rail_buttons:
    enabled: false  # Set to true if using rail buttons
    upper_button_position_m: 0.5   # (m) Distance from nose to upper button
    lower_button_position_m: 1.8   # (m) Distance from nose to lower button
    angular_position_deg: 45.0     # (degrees) Rotation around rocket axis
  
  # ================================================================================
  # RECOVERY SYSTEM
  # ================================================================================
  
  # --- PARACHUTE ---
  parachute:
    enabled: true  # Set to false for no parachute
    name: "Main"   # Name identifier
    
    # Drag coefficient × area product
    # Typical values: 5-15 m² for main chute, 0.5-2 m² for drogue
    # cd_s = Cd × π × r² where Cd ≈ 1.5-2.2 for parachutes
    cd_s: 10.0  # (m²) Effective drag area
    
    # Deployment trigger
    # Options: "apogee"           - Deploy at apogee (highest point)
    #          altitude_value     - Deploy at specific altitude (e.g., 500.0)
    #          callable function  - Custom trigger function
    trigger: "apogee"
    
    # Trigger evaluation parameters
    sampling_rate_hz: 105.0  # (Hz) How often to check trigger condition
    lag_s: 1.5               # (s) Delay from trigger to full deployment
    
    # Measurement noise (for Monte Carlo simulations)
    # [x_noise, y_noise, z_noise] standard deviations in meters
    noise_std: [0.0, 8.3, 0.5]  # (m) Noise in position measurements
  
  # ================================================================================
  # ACTIVE CONTROL (OPTIONAL)
  # ================================================================================
  
  # --- AIR BRAKES ---
  # Deployable drag surfaces for active apogee control
  air_brakes:
    enabled: false  # Set to true to include air brakes
    
    # Physical properties
    reference_area_m2: 0.01  # (m²) Drag area when fully deployed
    drag_coefficient: 1.5    # Drag coefficient of deployed brakes
    position_m: 1.0          # (m) Position from nose
    
    # Control law parameters
    controller:
      type: "pid"  # Options: "pid", "bang_bang"
      
      # Target apogee for controller
      target_apogee_m: 3000.0  # (m) Desired apogee altitude
      
      # PID gains (for type="pid")
      kp: 0.1   # Proportional gain
      ki: 0.01  # Integral gain
      kd: 0.05  # Derivative gain
  
  # ================================================================================
  # CUSTOM AERODYNAMICS (OPTIONAL)
  # ================================================================================
  
  # Custom drag coefficient curves (optional)
  # If not provided, RocketPy computes Cd from rocket geometry
  # CSV format: Mach, Cd
  power_off_drag: null  # Path to power-off drag curve or null
  # power_off_drag: "data/drag_curves/power_off_cd.csv"
  
  power_on_drag: null   # Path to power-on drag curve or null
  # power_on_drag: "data/drag_curves/power_on_cd.csv"

# ==================================================================================
# MOTOR CONFIGURATION
# ==================================================================================
motor:
  # Motor type
  # Options: "SolidMotor", "HybridMotor", "LiquidMotor"
  type: "SolidMotor"
  
  # --- THRUST CURVE ---
  # Path to thrust curve file
  # Supported formats: .eng (RASP format), .csv (time,thrust)
  thrust_source: "data/motors/Cesaroni_M2250.eng"
  
  # --- MASS PROPERTIES ---
  dry_mass_kg: 1.815  # (kg) Mass of motor casing and hardware (no propellant)
  
  # Dry inertia tensor [I_xx, I_yy, I_zz] of empty motor
  dry_inertia: [0.125, 0.125, 0.002]  # (kg·m²) [lateral, lateral, axial]
  
  # --- NOZZLE GEOMETRY ---
  nozzle_radius_m: 0.033   # (m) Radius of nozzle exit
  throat_radius_m: 0.011   # (m) Radius of nozzle throat (smallest section)
  
  # ================================================================================
  # PROPELLANT GRAIN CONFIGURATION (for SolidMotor)
  # ================================================================================
  # Defines solid propellant geometry - affects burn rate and thrust profile
  
  grain_number: 5  # Number of individual propellant grains
  
  # Propellant properties
  grain_density_kg_m3: 1815.0  # (kg/m³) Propellant bulk density
  
  # Grain geometry (typically cylindrical with central bore)
  grain_outer_radius_m: 0.033          # (m) Outer radius of grain
  grain_initial_inner_radius_m: 0.015  # (m) Initial bore radius (burns outward)
  grain_initial_height_m: 0.120        # (m) Length of each grain
  grain_separation_m: 0.005            # (m) Gap between grains
  
  # ================================================================================
  # MOTOR REFERENCE FRAME POSITIONS
  # ================================================================================
  # Motor uses its own coordinate system: "nozzle_to_combustion_chamber"
  # Origin at nozzle exit, positive direction toward combustion chamber
  
  grains_center_of_mass_position_m: 0.317  # (m) Grain CoM from nozzle
  center_of_dry_mass_position_m: 0.317     # (m) Dry motor CoM from nozzle
  nozzle_position_m: 0.0                   # (m) Always 0 in motor frame
  
  # --- BURN TIME ---
  # Motor burn duration (computed from thrust curve if null)
  burn_time_s: null  # (s) or null for auto-computation
  
  # ================================================================================
  # ADVANCED MOTOR PARAMETERS
  # ================================================================================
  
  # Thrust curve interpolation method
  # Options: "linear"  - Linear interpolation (fast, less accurate)
  #          "spline"  - Cubic spline (smooth, recommended)
  #          "akima"   - Akima spline (no overshoot)
  interpolation_method: "spline"
  
  # Motor coordinate system orientation
  coordinate_system_orientation: "nozzle_to_combustion_chamber"
  
  # ⚠️ CRITICAL: Reference atmospheric pressure
  # Pressure at which thrust curve was measured
  # Standard sea level: 101325 Pa (14.7 psi)
  # If thrust was measured in vacuum: 0 Pa
  # 
  # RocketPy automatically corrects thrust for altitude:
  #   F_total(h) = F_curve(t) + (P_ref - P_ambient(h)) × A_nozzle
  reference_pressure: 101325  # (Pa) Pressure during thrust measurement
  
  # ================================================================================
  # MOTOR POSITION IN ROCKET FRAME
  # ================================================================================
  # Position of motor nozzle EXIT in rocket's coordinate system
  # For nose_to_tail system: measure from nose to nozzle exit
  position_m: 2.0  # (m) Nozzle exit position from nose

# ==================================================================================
# ENVIRONMENT CONFIGURATION
# ==================================================================================
environment:
  # --- LAUNCH SITE LOCATION ---
  latitude_deg: 39.3897   # (degrees) Latitude (-90 to +90, North positive)
  longitude_deg: -8.2889  # (degrees) Longitude (-180 to +180, East positive)
  elevation_m: 100.0      # (m) Launch site elevation above sea level
  
  # --- ATMOSPHERIC MODEL ---
  # Defines temperature, pressure, density vs altitude
  # Options: "standard_atmosphere"  - ISA standard atmosphere
  #          "custom_atmosphere"    - Load from file
  atmospheric_model: "standard_atmosphere"
  
  # Path to custom atmosphere file (required if using custom model)
  # atmospheric_model_file: "data/atmosphere.nc"
  
  # --- DATE AND TIME ---
  # Launch date/time for solar position, Earth rotation effects
  # Format: [year, month, day, hour_utc]
  # Set to null to ignore date-specific effects
  date: null
  # Example: date: [2023, 6, 15, 14]  # June 15, 2023 at 14:00 UTC
  
  # ================================================================================
  # WIND MODEL
  # ================================================================================
  wind:
    # Wind model type
    # Options: "constant"      - Constant wind (simple, fast)
    #          "from_weather"  - Load from weather data
    #          "function"      - Custom wind function
    #          "custom"        - Load from file
    model: "constant"
    
    # For constant wind:
    velocity_ms: 5.0      # (m/s) Wind speed magnitude
    direction_deg: 90.0   # (degrees) Meteorological convention
                          # 0° = wind FROM North, 90° = FROM East
    
    # For weather-based wind:
    # weather:
    #   source: "wyoming"  # Options: wyoming, gfs, era5
    #   station: "72340"   # Weather station ID
    #   fetch_real_time: false
  
  # --- GRAVITY ---
  # Local gravitational acceleration
  # Standard Earth gravity: 9.80665 m/s²
  # Varies slightly with latitude and elevation
  gravity_ms2: 9.80665
  
  # --- SIMULATION BOUNDS ---
  # Maximum expected altitude (for atmospheric data preloading)
  max_expected_height_m: 5000.0  # (m)

# ==================================================================================
# SIMULATION SETTINGS
# ==================================================================================
simulation:
  # --- TIME INTEGRATION ---
  max_time_s: 600.0  # (s) Maximum simulation time (safety cutoff)
  
  # Integration time steps
  # Use .inf for automatic adaptive stepping (recommended)
  max_time_step_s: .inf  # (s) Maximum integration time step
  min_time_step_s: 0.0   # (s) Minimum integration time step
  
  # Integration tolerances (for adaptive ODE solver)
  # Smaller values = higher accuracy but slower
  # Typical values: 1e-6 to 1e-8
  rtol: 1e-6  # Relative tolerance
  atol: 1e-6  # Absolute tolerance
  
  # --- TERMINATION CONDITIONS ---
  # Stop simulation at apogee (saves computation time)
  terminate_on_apogee: false  # Set to true to stop at peak altitude
  
  # --- OUTPUT CONTROL ---
  verbose: false  # Set to true for detailed console output during simulation
  
  # ================================================================================
  # LAUNCH RAIL CONFIGURATION
  # ================================================================================
  rail:
    length_m: 5.0  # (m) Length of launch rail
    
    # Rail inclination from horizontal
    # 0° = horizontal, 90° = vertical
    inclination_deg: 85.0  # (degrees) Typical: 80-90° for near-vertical launch
    
    # Rail heading (azimuth direction)
    # 0° = North, 90° = East, 180° = South, 270° = West
    heading_deg: 0.0  # (degrees) Direction rail points toward

# ==================================================================================
# MONTE CARLO SIMULATION (OPTIONAL)
# ==================================================================================
# For uncertainty quantification and sensitivity analysis
monte_carlo:
  num_simulations: 100  # Number of Monte Carlo runs
  seed: 42              # Random seed for reproducibility (or null for random)
  
  # --- PARAMETER VARIATIONS ---
  # Define uncertainty in input parameters
  # Values are standard deviations (1-sigma) for Gaussian distributions
  variations:
    # Motor performance uncertainty
    motor_thrust_std_pct: 5.0      # (%) Thrust variation ±5%
    motor_total_impulse_std_pct: 2.5  # (%) Total impulse variation
    
    # Mass uncertainties
    dry_mass_std_kg: 0.5           # (kg) Rocket dry mass uncertainty
    propellant_mass_std_pct: 2.0   # (%) Propellant mass variation
    
    # Wind uncertainties
    wind_speed_std_ms: 2.0         # (m/s) Wind speed uncertainty
    wind_direction_std_deg: 15.0   # (degrees) Wind direction uncertainty
    
    # Aerodynamic uncertainties
    cd_std_pct: 10.0               # (%) Drag coefficient uncertainty
    
    # Position uncertainties
    cg_std_m: 0.01                 # (m) CoG position uncertainty
    cp_std_m: 0.02                 # (m) CoP position uncertainty
    
    # Rail uncertainties
    rail_inclination_std_deg: 1.0  # (degrees) Rail angle uncertainty
    rail_heading_std_deg: 2.0      # (degrees) Rail direction uncertainty

# ==================================================================================
# NOTES
# ==================================================================================
# - All positions are measured from the NOSE in nose_to_tail coordinate system
# - Inertia values are about the CENTER OF MASS, not the nose
# - Motor uses its own coordinate system with nozzle at origin
# - Wind direction uses meteorological convention (wind FROM direction)
# - Reference pressure in motor config is CRITICAL for accurate altitude correction
# - For symmetric rockets: I_xx = I_yy and all products of inertia = 0
# ==================================================================================
